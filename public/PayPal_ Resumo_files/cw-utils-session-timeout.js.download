/*! For license information please see cw-utils-session-timeout.js.LICENSE.txt */
"use strict";(self.webpackChunkcommonutilsnodeserv=self.webpackChunkcommonutilsnodeserv||[]).push([[932],{1020:function(e,t,r){var n=r(9758);Symbol.for("react.element"),Symbol.for("react.fragment"),Object.prototype.hasOwnProperty,n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner},1460:function(e,t,r){var n,s,i=r(8217),o=r.n(i),c=r(1304),u=(r(4848),Object.create),a=Object.defineProperty,l=Object.getOwnPropertyDescriptor,h=Object.getOwnPropertyNames,d=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty,f=(n=(e,t)=>{var n,s;n=e,s=function(e){var t,r=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,n=536870912,s=2*n,i=new WeakMap,o=function(e,t){return function(i){var o=t.get(i),c=void 0===o?i.size:o<s?o+1:0;if(!i.has(c))return e(i,c);if(i.size<n){for(;i.has(c);)c=Math.floor(Math.random()*s);return e(i,c)}if(i.size>r)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;i.has(c);)c=Math.floor(Math.random()*r);return e(i,c)}}((t=i,function(e,r){return t.set(e,r),r}),i),c=function(e){return function(t){var r=e(t);return t.add(r),r}}(o);e.addUniqueNumber=c,e.generateUniqueNumber=o},"object"==typeof e&&typeof t<"u"?s(e):"function"==typeof define&&r.amdO?define(["exports"],s):s((n=typeof globalThis<"u"?globalThis:n||self).fastUniqueNumbers={})},()=>(s||n((s={exports:{}}).exports,s),s.exports));c.Component;((e,t,r)=>{r=null!=e?u(d(e)):{},((e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of h(t))!m.call(e,r)&&undefined!==r&&a(e,r,{get:()=>t[r],enumerable:!(n=l(t,r))||n.enumerable})})(e&&e.__esModule?r:a(r,"default",{value:e,enumerable:!0}),e)})(f());var p="object"==(typeof window>"u"?"undefined":typeof window),v={setTimeout:p?setTimeout.bind(window):setTimeout,clearTimeout:p?clearTimeout.bind(window):clearTimeout,setInterval:p?setInterval.bind(window):setInterval,clearInterval:p?clearInterval.bind(window):clearInterval},g={},w=typeof window>"u"?void 0:"function"==typeof window.BroadcastChannel?window.BroadcastChannel:class{name;closed=!1;mc=new MessageChannel;constructor(e){this.name=e,g[e]=g[e]||[],g[e].push(this),this.mc.port1.start(),this.mc.port2.start(),this.onStorage=this.onStorage.bind(this),window.addEventListener("storage",this.onStorage)}onStorage(e){if(e.storageArea!==window.localStorage||e.key.substring(0,this.name.length)!==this.name||null===e.newValue)return;let t=JSON.parse(e.newValue);this.mc.port2.postMessage(t)}postMessage(e){if(this.closed)throw new Error("InvalidStateError");let t=JSON.stringify(e),r=`${this.name}:${String(Date.now())}${String(Math.random())}`;window.localStorage.setItem(r,t),v.setTimeout((()=>{window.localStorage.removeItem(r)}),500),g[this.name].forEach((e=>{e!==this&&e.mc.port2.postMessage(JSON.parse(t))}))}close(){if(this.closed)return;this.closed=!0,this.mc.port1.close(),this.mc.port2.close(),window.removeEventListener("storage",this.onStorage);let e=g[this.name].indexOf(this);g[this.name].splice(e,1)}get onmessage(){return this.mc.port1.onmessage}set onmessage(e){this.mc.port1.onmessage=e}get onmessageerror(){return this.mc.port1.onmessageerror}set onmessageerror(e){this.mc.port1.onmessageerror=e}addEventListener(e,t){return this.mc.port1.addEventListener(e,t)}removeEventListener(e,t){return this.mc.port1.removeEventListener(e,t)}dispatchEvent(e){return this.mc.port1.dispatchEvent(e)}};function b(){return Math.random().toString(36).substring(2)}var y=class{options;channel;token=b();isLeader=!1;isDead=!1;isApplying=!1;reApply=!1;intervals=[];listeners=[];deferred;constructor(e,t){this.channel=e,this.options=t,this.apply=this.apply.bind(this),this.awaitLeadership=this.awaitLeadership.bind(this),this.sendAction=this.sendAction.bind(this)}async apply(){if(this.isLeader||this.isDead)return!1;if(this.isApplying)return this.reApply=!0,!1;this.isApplying=!0;let e=!1,t=t=>{let{token:r,action:n}=t.data;r!==this.token&&(0===n&&r>this.token&&(e=!0),1===n&&(e=!0))};this.channel.addEventListener("message",t);try{return this.sendAction(0),await function(e=0){return new Promise((t=>v.setTimeout(t,e)))}(this.options.responseTime),this.channel.removeEventListener("message",t),this.isApplying=!1,e?!!this.reApply&&this.apply():(this.assumeLead(),!0)}catch{return!1}}awaitLeadership(){if(this.isLeader)return Promise.resolve();let e=!1,t=null;return new Promise((r=>{let n=()=>{if(e)return;e=!0;try{v.clearInterval(t)}catch{}let n=this.intervals.indexOf(t);n>=0&&this.intervals.splice(n,1),this.channel.removeEventListener("message",s),r()};t=v.setInterval((()=>{this.apply().then((()=>{this.isLeader&&n()}))}),this.options.fallbackInterval),this.intervals.push(t);let s=e=>{let{action:t}=e.data;2===t&&this.apply().then((()=>{this.isLeader&&n()}))};this.channel.addEventListener("message",s)}))}sendAction(e){this.channel.postMessage({action:e,token:this.token})}assumeLead(){this.isLeader=!0;let e=e=>{let{action:t}=e.data;0===t&&this.sendAction(1)};return this.channel.addEventListener("message",e),this.listeners.push(e),this.sendAction(1)}waitForLeadership(){return this.deferred||(this.deferred=this.awaitLeadership()),this.deferred}close(){if(!this.isDead){this.isDead=!0,this.isLeader=!1,this.sendAction(2);try{this.listeners.forEach((e=>this.channel.removeEventListener("message",e))),this.intervals.forEach((e=>v.clearInterval(e)))}catch{}}}},E=class{channel;options;elector;token=b();registry=new Map;allIdle=!1;isLastActive=!1;constructor(e){let{channelName:t}=e;if(this.options=e,this.channel=new w(t),this.registry.set(this.token,1),e.leaderElection){let e={fallbackInterval:2e3,responseTime:100};this.elector=new y(this.channel,e),this.elector.waitForLeadership()}this.channel.addEventListener("message",(e=>{let{action:t,token:r,data:n}=e.data;switch(t){case 3:this.registry.set(r,2);break;case 4:this.registry.delete(r);break;case 5:this.idle(r);break;case 6:this.active(r);break;case 7:this.prompt(r);break;case 8:this.start(r);break;case 9:this.reset(r);break;case 10:this.activate(r);break;case 11:this.pause(r);break;case 12:this.resume(r);break;case 13:this.options.onMessage(n)}})),this.send(3)}get isLeader(){if(!this.elector)throw new Error('❌ Leader election is not enabled. To Enable it set the "leaderElection" property to true.');return this.elector.isLeader}prompt(e=this.token){this.registry.set(e,0);let t=[...this.registry.values()].every((e=>0===e));e===this.token&&this.send(7),t&&this.options.onPrompt()}idle(e=this.token){this.registry.set(e,2);let t=[...this.registry.values()].every((e=>2===e));e===this.token&&this.send(5),!this.allIdle&&t&&(this.allIdle=!0,this.options.onIdle())}active(e=this.token){this.allIdle=!1,this.registry.set(e,1);let t=[...this.registry.values()].some((e=>1===e));e===this.token&&this.send(6),t&&this.options.onActive(),this.isLastActive=e===this.token}start(e=this.token){this.allIdle=!1,this.registry.set(e,1),e===this.token?this.send(8):this.options.start(!0),this.isLastActive=e===this.token}reset(e=this.token){this.allIdle=!1,this.registry.set(e,1),e===this.token?this.send(9):this.options.reset(!0),this.isLastActive=e===this.token}activate(e=this.token){this.allIdle=!1,this.registry.set(e,1),e===this.token?this.send(10):this.options.activate(!0),this.isLastActive=e===this.token}pause(e=this.token){e===this.token?this.send(11):this.options.pause(!0)}resume(e=this.token){e===this.token?this.send(12):this.options.resume(!0)}message(e){try{this.channel.postMessage({action:13,token:this.token,data:e})}catch{}}send(e){try{this.channel.postMessage({action:e,token:this.token})}catch{}}close(){this.options.leaderElection&&this.elector.close(),this.send(4),this.channel.close()}},T=p?document:null,k=["mousemove","keydown","wheel","DOMMouseScroll","mousewheel","mousedown","touchstart","touchmove","MSPointerDown","MSPointerMove","visibilitychange","focus"];function L(e,t){let r=0;return function(...n){let s=(new Date).getTime();if(!(s-r<t))return r=s,e(...n)}}var I=()=>Date.now(),M=2147483647;(0,c.createContext)(null).Consumer;var S=r(9707),C=r(5297),O=r(9909),R=r(2370),A=r(4644);function _(e){let{method:t,url:r}=e;const n=new XMLHttpRequest;n.onreadystatechange=function(){4===this.readyState&&401===n.status&&(window.location.href="/signin")},n.open(t.toUpperCase(),r,!0),n.send()}const N={extendSession:null,endSession:function(){window.document.location="/signout"},onBeforeLogout:async()=>{},onBeforeModalOpen:async()=>{},onAfterModalClose:async()=>{},sessionTimeout:900,sessionExtensionBuffer:60,timeUntilModalPercentage:80};function P(e){let{content:t,config:r,clientConfig:n}=e;const[s,u]=(0,i.useState)(!1),a={...N,...r,...n},{extendSession:l,endSession:h,onBeforeLogout:d,onBeforeModalOpen:m,onAfterModalClose:f}=a,{timeout:g,promptTimeout:w,sessionExtensionTimeout:b}=function(e){const{sessionTimeout:t,sessionTimeoutOverride:r,sessionExtensionBuffer:n,timeUntilModalPercentage:s}=e,i=r||t,o=1e3*i,c=o*s/100;return{timeout:c,promptTimeout:o-c,sessionExtensionTimeout:1e3*(i-n)}}(a),{reset:y}=function({timeout:e=12e5,promptTimeout:t=0,promptBeforeIdle:r=0,element:n=T,events:s=k,timers:i,immediateEvents:o=[],onPresenceChange:u=()=>{},onPrompt:a=()=>{},onIdle:l=()=>{},onActive:h=()=>{},onAction:d=()=>{},onMessage:m=()=>{},debounce:f=0,throttle:g=0,eventsThrottle:w=200,startOnMount:b=!0,startManually:y=!1,stopOnIdle:S=!1,crossTab:C=!1,name:O="idle-timer",syncTimers:R=0,leaderElection:A=!1,disabled:_=!1}={}){let N=(0,c.useRef)(I()),P=(0,c.useRef)(I()),x=(0,c.useRef)(null),B=(0,c.useRef)(null),D=(0,c.useRef)(0),j=(0,c.useRef)(0),U=(0,c.useRef)(0),$=(0,c.useRef)(0),J=(0,c.useRef)(!1),q=(0,c.useRef)(!1),F=(0,c.useRef)(!1),z=(0,c.useRef)(!0),H=(0,c.useRef)(!1),G=(0,c.useRef)(null),X=(0,c.useRef)(null),V=(0,c.useRef)(e),W=(0,c.useRef)(0);(0,c.useEffect)((()=>{if(t&&console.warn("⚠️ IdleTimer -- The `promptTimeout` property has been deprecated in favor of `promptBeforeIdle`. It will be removed in the next major release."),r&&t)throw new Error("❌ Both promptTimeout and promptBeforeIdle can not be set. The promptTimeout property will be deprecated in a future version.");if(e>=M)throw new Error(`❌ The value for the timeout property must fit in a 32 bit signed integer, ${M}.`);if(t>=M)throw new Error(`❌ The value for the promptTimeout property must fit in a 32 bit signed integer, ${M}.`);if(r>=M)throw new Error(`❌ The value for the promptBeforeIdle property must fit in a 32 bit signed integer, ${M}.`);if(r>=e)throw new Error(`❌ The value for the promptBeforeIdle property must be less than the timeout property, ${e}.`);if(r?(V.current=e-r,W.current=r):(V.current=e,W.current=t),!z.current){if(y||_)return;J.current&&(se.current(null,Ue),X.current&&X.current.active()),be()}}),[e,t,r,y,_]);let Y=(0,c.useRef)(S);(0,c.useEffect)((()=>{Y.current=S}),[S]);let K=(0,c.useRef)(o),Q=(0,c.useRef)(n),Z=(0,c.useRef)([...new Set([...s,...o]).values()]),ee=(0,c.useRef)(_);(0,c.useEffect)((()=>{ee.current=_,!z.current&&(_?Te():y||be())}),[_]);let te=(0,c.useRef)(u);(0,c.useEffect)((()=>{te.current=u}),[u]);let re=(0,c.useRef)(a);(0,c.useEffect)((()=>{re.current=a}),[a]);let ne=(0,c.useRef)(l);(0,c.useEffect)((()=>{ne.current=l}),[l]);let se=(0,c.useRef)(h);(0,c.useEffect)((()=>{se.current=h}),[h]);let ie=(0,c.useRef)(d);(0,c.useEffect)((()=>{ie.current=d}),[d]);let oe=(0,c.useRef)(m);(0,c.useEffect)((()=>{oe.current=m}),[m]);let ce=(0,c.useMemo)((()=>{let e=(e,t)=>ie.current(e,t);return f>0?function(e,t){let r;function n(...n){r&&clearTimeout(r),r=setTimeout((()=>{e(...n),r=null}),t)}return n.cancel=function(){clearTimeout(r)},n}(e,f):g>0?L(e,g):e}),[g,f]),ue=(0,c.useRef)();(0,c.useEffect)((()=>{C&&R&&(ue.current=L((()=>{X.current.active()}),R))}),[C,R]);let ae=()=>{null!==G.current&&(v.clearTimeout(G.current),G.current=null)},le=(e,t=!0)=>{ae(),G.current=v.setTimeout(fe,e||V.current),t&&(B.current=I())},he=e=>{!q.current&&!J.current&&(re.current(e,Ue),te.current({type:"active",prompted:!0},Ue)),$.current=0,U.current=I(),q.current=!0,le(W.current,!1)},de=()=>{ae(),J.current||(ne.current(null,Ue),te.current({type:"idle"},Ue)),J.current=!0,x.current=I(),Y.current?we():q.current&&(U.current=0,q.current=!1)},me=e=>{ae(),(J.current||q.current)&&(se.current(e,Ue),te.current({type:"active",prompted:!1},Ue)),q.current=!1,U.current=0,J.current=!1,D.current+=I()-x.current,j.current+=I()-x.current,ge(),le()},fe=e=>{if(!J.current){ce.cancel&&ce.cancel();let t=I()-B.current;return V.current+W.current<t||!(W.current>0)||q.current?void(X.current?X.current.idle():de()):void(X.current?X.current.prompt():he(e))}X.current?X.current.active():me(e)},pe=e=>{if(!b&&!B.current&&(B.current=I(),se.current(null,Ue)),ce(e,Ue),q.current)return;if(ae(),!J.current&&K.current.includes(e.type))return void fe(e);let t=I()-B.current;J.current&&!S||!J.current&&t>=V.current?fe(e):(F.current=!1,$.current=0,U.current=0,le(),C&&R&&ue.current())},ve=(0,c.useRef)(pe);(0,c.useEffect)((()=>{let e=H.current;e&&we(),ve.current=w>0?L(pe,w):pe,e&&ge()}),[w,g,f,ie,C,R]);let ge=()=>{p&&Q.current&&(H.current||(Z.current.forEach((e=>{Q.current.addEventListener(e,ve.current,{capture:!0,passive:!0})})),H.current=!0))},we=(e=!1)=>{p&&Q.current&&(H.current||e)&&(Z.current.forEach((e=>{Q.current.removeEventListener(e,ve.current,{capture:!0})})),H.current=!1)},be=(0,c.useCallback)((e=>!ee.current&&(ae(),ge(),J.current=!1,q.current=!1,F.current=!1,$.current=0,U.current=0,X.current&&!e&&X.current.start(),le(),!0)),[G,J,ee,V,X]),ye=(0,c.useCallback)((e=>!ee.current&&(ae(),ge(),P.current=I(),D.current+=I()-x.current,j.current+=I()-x.current,D.current=0,J.current=!1,q.current=!1,F.current=!1,$.current=0,U.current=0,X.current&&!e&&X.current.reset(),y||le(),!0)),[G,J,V,y,ee,X]),Ee=(0,c.useCallback)((e=>!ee.current&&(ae(),ge(),(J.current||q.current)&&me(),J.current=!1,q.current=!1,F.current=!1,$.current=0,U.current=0,P.current=I(),X.current&&!e&&X.current.activate(),le(),!0)),[G,J,q,ee,V,X]),Te=(0,c.useCallback)(((e=!1)=>!ee.current&&!F.current&&($.current=Re(),F.current=!0,we(),ae(),X.current&&!e&&X.current.pause(),!0)),[G,ee,X]),ke=(0,c.useCallback)(((e=!1)=>!(ee.current||!F.current||(F.current=!1,q.current||ge(),J.current||le($.current),U.current&&(U.current=I()),X.current&&!e&&X.current.resume(),0))),[G,V,ee,$,X]),Le=(0,c.useCallback)(((e,t)=>(X.current?(t&&oe.current(e,Ue),X.current.message(e)):t&&oe.current(e,Ue),!0)),[m]),Ie=(0,c.useCallback)((()=>J.current),[J]),Me=(0,c.useCallback)((()=>q.current),[q]),Se=(0,c.useCallback)((()=>X.current?X.current.isLeader:null),[X]),Ce=(0,c.useCallback)((()=>X.current?X.current.isLastActive:null),[X]),Oe=(0,c.useCallback)((()=>X.current?X.current.token:null),[X]),Re=(0,c.useCallback)((()=>{if(F.current)return $.current;let e=$.current?$.current:W.current+V.current,t=B.current?I()-B.current:0,r=Math.floor(e-t);return r<0?0:Math.abs(r)}),[V,W,q,$,B]),Ae=(0,c.useCallback)((()=>Math.round(I()-P.current)),[P]),_e=(0,c.useCallback)((()=>Math.round(I()-N.current)),[N]),Ne=(0,c.useCallback)((()=>x.current?new Date(x.current):null),[x]),Pe=(0,c.useCallback)((()=>B.current?new Date(B.current):null),[B]),xe=(0,c.useCallback)((()=>J.current?Math.round(I()-x.current+D.current):Math.round(D.current)),[x,D]),Be=(0,c.useCallback)((()=>J.current?Math.round(I()-x.current+j.current):Math.round(j.current)),[x,j]),De=(0,c.useCallback)((()=>{let e=Math.round(Ae()-xe());return e>=0?e:0}),[x,D]),je=(0,c.useCallback)((()=>{let e=Math.round(_e()-Be());return e>=0?e:0}),[x,D]);(0,c.useEffect)((()=>{if(f>0&&g>0)throw new Error("❌ onAction can either be throttled or debounced, not both.");i&&function(e){v.setTimeout=e.setTimeout,v.clearTimeout=e.clearTimeout,v.setInterval=e.setInterval,v.clearInterval=e.clearInterval}(i);let e=()=>{X.current&&X.current.close(),ce.cancel&&ce.cancel(),ae(),we(!0)};return p&&window.addEventListener("beforeunload",e),()=>{p&&window.removeEventListener("beforeunload",e),X.current&&X.current.close(),ce.cancel&&ce.cancel(),ae(),we(!0)}}),[]),(0,c.useEffect)((()=>{X.current&&X.current.close(),X.current=C?new E({channelName:O,leaderElection:A,onPrompt:()=>{he()},onIdle:()=>{de()},onActive:()=>{me()},onMessage:e=>{oe.current(e,Ue)},start:be,reset:ye,activate:Ee,pause:Te,resume:ke}):null}),[C,O,A,re,ne,se,oe,be,ye,Te,ke]),(0,c.useEffect)((()=>{z.current||(ae(),we(!0)),!y&&!_&&(b?be():ge())}),[y,b,_,z]),(0,c.useEffect)((()=>{if(!z.current){let e=[...new Set([...s,...o]).values()];if(we(),Z.current=e,Q.current=n,K.current=o,y||_)return;b?be():ge()}}),[n,JSON.stringify(s),JSON.stringify(o),z,_,y,b]),(0,c.useEffect)((()=>{z.current&&(z.current=!1)}),[z]);let Ue={message:Le,start:be,reset:ye,activate:Ee,pause:Te,resume:ke,isIdle:Ie,isPrompted:Me,isLeader:Se,isLastActiveTab:Ce,getTabId:Oe,getRemainingTime:Re,getElapsedTime:Ae,getTotalElapsedTime:_e,getLastIdleTime:Ne,getLastActiveTime:Pe,getIdleTime:xe,getTotalIdleTime:Be,getActiveTime:De,getTotalActiveTime:je,setOnPresenceChange:e=>{u=e,te.current=e},setOnPrompt:e=>{a=e,re.current=e},setOnIdle:e=>{l=e,ne.current=e},setOnActive:e=>{h=e,se.current=e},setOnAction:e=>{d=e,ie.current=e},setOnMessage:e=>{m=e,oe.current=e}};return Ue}({onPrompt:async()=>{try{await(null==m?void 0:m())}catch(e){console.error(new Error("Session timeout modal tried to run onBeforeModalOpen method but failed.",{cause:e}))}u(!0)},onIdle:async()=>{try{await(null==d?void 0:d())}catch(e){console.error(new Error("Session timeout modal tried to run onBeforeLogout method but failed.",{cause:e}))}null==h||h()},timeout:g,promptTimeout:w,stopOnIdle:!0});return(0,i.useEffect)((()=>{b>0?setInterval((()=>{return(e=l)?("function"==typeof e&&e(),"object"==typeof e?_({...e}):"string"==typeof e?_({method:"GET",url:e}):null):null;var e}),b):console.warn("Session extension will not run since sessionExtensionTimeout (".concat(b,") is invalid"))}),[]),l||console.error("SessionTimeoutModal requires extendSession to be set. Use function, URL, or {url, method}"),o().createElement(R.a,{theme:O.m},o().createElement(A.cj,{isOpen:s&&l,center:!0,title:"",onClose:f},o().createElement("img",{src:"https://www.paypalobjects.com/paypal-ui/illustrations/focused/svg/empty-warning.svg",alt:"empty-warning",className:"cw-sessionTimeout__image"}),o().createElement(C.yJ,{size:"sm",className:"cw-sessionTimeout__header","data-test-id":"session-timeout-header"},null==t?void 0:t.timeoutHeader),o().createElement(C.a3,{className:"cw-sessionTimeout__body","data-test-id":"session-timeout-message"},null==t?void 0:t.timeoutMessage),o().createElement(S.$n,{id:"extendSession-btn",className:"cw-sessionTimeout__action",name:"extendSession","data-test-id":"session-timeout-action",onClick:()=>{u(!1),y()}},null==t?void 0:t.extendSession)))}var x=r(5338);window.addEventListener("DOMContentLoaded",(function(){if(window.cwSessionTimeoutConfig){const t=document.getElementById("cw_sessiontimeout");if(t){let r={config:{},content:{}};try{var e;const t=(null===(e=document.getElementById("cw_sessiontimeout__props"))||void 0===e?void 0:e.innerHTML)||"{}";r=JSON.parse(t)}catch(e){console.error(new Error("User tried to parse session timeout modal props",{cause:e}))}const n=o().createElement(P,{...r,clientConfig:window.cwSessionTimeoutConfig},null);(0,x.H)(t).render(n)}}}))},4848:function(e,t,r){r(1020)}},function(e){e(e.s=1460)}]);